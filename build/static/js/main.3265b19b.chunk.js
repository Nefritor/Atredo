(this.webpackJsonpatredo=this.webpackJsonpatredo||[]).push([[0],{19:function(e,t,a){e.exports=a(27)},26:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"Main",(function(){return x})),a.d(n,"Account",(function(){return V})),a.d(n,"Constructor",(function(){return W}));var o=a(0),r=a.n(o),i=a(13),c=a.n(i),s=a(18),p=a(9),l=a(3),u=a(4),d=a(5),h=a(2),m=a(6);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var b=r.a.createElement("path",{fill:"url(#darkGradient)"},r.a.createElement("animate",{attributeName:"d",dur:"1000ms",repeatCount:"indefinite",keyTimes:"0;                              .33;                              .66;                              1",calcMode:"spline",keySplines:"0.8 0 0.2 1;                                0.8 0 0.2 1;                                0.8 0 0.2 1;",values:"                            M 100 50                            A 1 1 90 1 0 100 70                            L 100 70                            A 1 1 90 1 0 100 50                            L 100 50                            Z;                            M 100 50                            A 1 1 90 1 0 100 70                            L 200 70                            A 1 1 90 1 0 200 50                            L 100 50                            Z;                            M 200 50                            A 1 1 90 1 0 200 70                            L 200 70                            A 1 1 90 1 0 200 50                            L 200 50                            Z;                            M 200 150                            A 1 1 90 1 0 200 170                            L 200 170                            A 1 1 90 1 0 200 150                            L 200 150                            Z;"})),v=r.a.createElement("path",{fill:"url(#darkGradient)"},r.a.createElement("animate",{attributeName:"d",dur:"1000ms",repeatCount:"indefinite",keyTimes:"0;                                .33;                                .66;                                1",calcMode:"spline",keySplines:"0.8 0 0.2 1;                                  0.8 0 0.2 1;                                  0.8 0 0.2 1;",values:"                              M 150 100                              A 1 1 90 1 0 150 120                              L 150 120                              A 1 1 90 1 0 150 100                              L 150 100                              Z;                              M 100 100                              A 1 1 90 1 0 100 120                              L 200 120                              A 1 1 90 1 0 200 100                              L 100 100                              Z;                              M 150 100                              A 1 1 90 1 0 150 120                              L 150 120                              A 1 1 90 1 0 150 100                              L 150 100                              Z;                              M 150 100                              A 1 1 90 1 0 150 120                              L 150 120                              A 1 1 90 1 0 150 100                              L 150 100                              Z;"})),y=r.a.createElement("path",{fill:"url(#darkGradient)"},r.a.createElement("animate",{attributeName:"d",dur:"1000ms",repeatCount:"indefinite",keyTimes:"0;                                  .33;                                  .66;                                  1",calcMode:"spline",keySplines:"0.8 0 0.2 1;                                    0.8 0 0.2 1;                                    0.8 0 0.2 1;",values:"                                M 200 150                                A 1 1 90 1 0 200 170                                L 200 170                                A 1 1 90 1 0 200 150                                L 200 150                                Z;                                M 100 150                                A 1 1 90 1 0 100 170                                L 200 170                                A 1 1 90 1 0 200 150                                L 100 150                                Z;                                M 100 150                                A 1 1 90 1 0 100 170                                L 100 170                                A 1 1 90 1 0 100 150                                L 100 150                                Z;                                M 100 50                                A 1 1 90 1 0 100 70                                L 100 70                                A 1 1 90 1 0 100 50                                L 100 50                                Z;"})),O=r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"darkGradient",x1:"30%",y1:"70%"},r.a.createElement("stop",{offset:"20%",stopColor:"#d54bec"},r.a.createElement("animate",{attributeName:"stop-color",dur:"3000ms",values:"#d54bec; #f13e3e; #d54bec",repeatCount:"indefinite"})),r.a.createElement("stop",{offset:"80%",stopColor:"#f754c3"},r.a.createElement("animate",{attributeName:"stop-color",dur:"3000ms",values:"#f754c3; #f1603e; #f754c3",repeatCount:"indefinite"})))),j=function(e){var t=e.svgRef,a=e.title,n=f(e,["svgRef","title"]);return r.a.createElement("svg",g({viewBox:"0 0 300 230",ref:t},n),a?r.a.createElement("title",null,a):null,b,v,y,O)},P=r.a.forwardRef((function(e,t){return r.a.createElement(j,g({svgRef:t},e))}));a.p;function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).appHandlers=e.appHandlers,a.state={dataReady:!1,loading:{show:!0,transparent:!0},popup:{show:!1,transparent:!0},navBarActions:void 0},a.reloadPage(),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"reloadPage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.config;new Promise((function(a){e.startLoading(),e.getData(t,a)})).then((function(t){e.setState({pageData:t}),e.appHandlers.setNavBarActions(e.state.navBarActions),e.stopLoading()}))}},{key:"startLoading",value:function(){var e=this;this.loadingTimeout=setTimeout((function(){e.setState({loading:{show:!0,transparent:!1}})}),0)}},{key:"stopLoading",value:function(){var e=this;clearTimeout(this.loadingTimeout),this.setState({loading:{show:!0,transparent:!0},dataReady:!0}),setTimeout((function(){e.setState({loading:{show:!1,transparent:!0}})}),300)}},{key:"openPopup",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,o){!1===t.state.popup.show&&e?(t.setState({popupComponent:e,popupData:a,popup:{show:!0,transparent:!0}}),setTimeout((function(){t.setState({popup:{show:!0,transparent:!1}})}),0),t.popupDataReady=Promise.resolve(),t.closePopupResolver=n.bind(t)):e?(console.warn("Popup opening try has been observed and cancelled"),o()):(console.warn("Trying to open popup without template"),o())}))}},{key:"closePopup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.closePopupResolver?this.popupDataReady.then((function(){t||e.closePopupResolver(e.state.popupData),e.closePopupResolver=void 0,e.setState({popup:{show:!0,transparent:!0}}),setTimeout((function(){e.setState({popupComponent:void 0,popupData:void 0,popup:{show:!1,transparent:!0}})}),300)})):console.warn("There is no active popup")}},{key:"updatePopup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.popupComponent,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.popupData;this.setState({popupComponent:e,popupData:t})}},{key:"popupHandlers",value:function(){return{open:this.openPopup.bind(this),close:this.closePopup.bind(this),update:this.updatePopup.bind(this),getValue:this.getPopupPropValue.bind(this),setValue:this.setPopupPropValue.bind(this)}}},{key:"loadingHandlers",value:function(){return{start:this.startLoading.bind(this),stop:this.stopLoading.bind(this)}}},{key:"popupDataChange",value:function(e,t){this.setPopupPropValue(e,t.target.value)}},{key:"setPopupPropValue",value:function(e,t){var a=this;this.popupDataReady=new Promise((function(n){a.setState({popupData:E({},a.state.popupData,Object(p.a)({},e,t))},(function(){n()}))}))}},{key:"getPopupPropValue",value:function(e){return this.state.popupData[e]}},{key:"popupBackgroundClick",value:function(e){"popupBackground"===e.target.id&&this.closePopup(!0)}},{key:"getData",value:function(){throw Error("Data getter must be declared inside child component")}},{key:"getRender",value:function(){throw Error("Renderer must be declared inside child component")}},{key:"getLoadingClassName",value:function(e,t){return e.show?e.transparent?"".concat(t,"-transparent"):"".concat(t,"-loading"):"".concat(t,"-hidden")}},{key:"getLoader",value:function(){return r.a.createElement("div",{className:this.getLoadingClassName(this.state.loading,"App-body-page-loadingAnimation")},r.a.createElement(P,{className:"App-body-page-loadingAnimation"}))}},{key:"getPopup",value:function(){return r.a.createElement("div",{className:"App-body-page-popup ".concat(this.getLoadingClassName(this.state.popup,"App-body-page-popup")),onClick:this.popupBackgroundClick.bind(this),id:"popupBackground"},r.a.createElement(this.state.popupComponent,null))}},{key:"render",value:function(){return r.a.createElement("div",{className:"App-body-page"},this.state.dataReady&&this.getRender(),this.state.loading.show&&this.getLoader(),this.state.popup.show&&this.getPopup())}}]),t}(r.a.Component),w=a(12),N=a(7),A=a(11);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var C=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"fetchData",value:function(e,t,a){var n=this;if(this.endpoint)return new Promise((function(o){setTimeout((function(){o(function(){switch(n.endpoint){case"Main":return n._fromMain(e,t);case"Operation":return n._fromOperations(e,t);case"Project":return n._fromProjects(e,t,a);default:throw Error('Unknown endpoint "'.concat(n.endpoint,'"'))}}())}),300)}));throw Error('There is no endpoint at "'.concat(e,'" request'))}},{key:"_fromMain",value:function(e,t){switch(e){case"getProjectList":return this.getJsonFromLocalStorage("Projects");case"addProject":return this.addItemToLocalStorage("Projects",t);default:throw Error('Unknown request "'.concat(this.endpoint,".").concat(e,'"'))}}},{key:"_fromOperations",value:function(e,t){switch(e){case"getAction":return this.getJsonFromLocalStorage("Actions").find((function(e){return e.key===t}));case"getActor":return this.getJsonFromLocalStorage("Actors").find((function(e){return e.key===t}));case"getObject":return this.getJsonFromLocalStorage("Objects").find((function(e){return e.key===t}));case"getActionsList":return this.getJsonFromLocalStorage("Actions");case"getActorsList":return this.getJsonFromLocalStorage("Actors");case"getObjectsList":return this.getJsonFromLocalStorage("Objects");case"addAction":return this.addItemToLocalStorage("Actions",t);case"addActor":return this.addItemToLocalStorage("Actors",t);case"addObject":return this.addItemToLocalStorage("Objects",t);case"removeAction":return this.updateItemInLocalStorage("Actions",t);case"removeActor":return this.updateItemInLocalStorage("Actors",t);case"removeObject":return this.updateItemInLocalStorage("Objects",t);default:throw Error('Unknown request "'.concat(this.endpoint,".").concat(e,'"'))}}},{key:"_fromProjects",value:function(e,t,a){switch(e){case"getStagesList":return this.getItemFromLocalStorage("Stages",t);case"addStage":return this.addItemToLocalStorage("Stages",a,t);case"updateStagesList":return this.updateItemInLocalStorage("Stages",t,a);default:throw Error('Unknown request "'.concat(this.endpoint,".").concat(e,'"'))}}},{key:"getJsonFromLocalStorage",value:function(e){return JSON.parse(localStorage.getItem(e))||[]}},{key:"addItemToLocalStorage",value:function(e,t,a){var n=this.getJsonFromLocalStorage(e),o=a?a-1:Math.max.apply(Math,Object(A.a)(n.map((function(e){return e.key}))).concat([-1]));return n.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({key:o+1},t)),localStorage.setItem(e,JSON.stringify(n)),o+1}},{key:"getItemFromLocalStorage",value:function(e,t){return this.getJsonFromLocalStorage(e).find((function(e){return e.key===t}))||[]}},{key:"updateItemInLocalStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,a=arguments.length>2?arguments[2]:void 0,n=this.getJsonFromLocalStorage(e),o=function(){for(var e in n)if(n.hasOwnProperty(e)&&n[e].key===t)return e}();if(o){var r=[parseInt(o,10),1];return a&&r.push(a),n.splice.apply(n,r),localStorage.setItem(e,JSON.stringify(n)),a}if(-1!==t)return n.push(a),localStorage.setItem(e,JSON.stringify(n)),a;console.warn('There is nothing to update... Unknown key "'.concat(t,'" of "').concat(e,'"'))}}]),e}(),D=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,null,[{key:"getProjectList",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getProjectList",e)}},{key:"addProject",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"addProject",e)}},{key:"endpoint",get:function(){return"Main"}}]),t}(C),_=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,null,[{key:"getStagesList",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getStagesList",e)}},{key:"addStage",value:function(e,a){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"addStage",a,e)}},{key:"updateStagesList",value:function(e,a){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"updateStagesList",e,a)}}]),t}(C);_.endpoint="Project";var I=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,null,[{key:"getAction",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getAction",e)}},{key:"getActor",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getActor",e)}},{key:"getObject",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getObject",e)}},{key:"getActionsList",value:function(){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getActionsList")}},{key:"getActorsList",value:function(){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getActorsList")}},{key:"getObjectsList",value:function(){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"getObjectsList")}},{key:"addAction",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"addAction",e)}},{key:"addActor",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"addActor",e)}},{key:"addObject",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"addObject",e)}},{key:"removeAction",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"removeAction",e)}},{key:"removeActor",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"removeActor",e)}},{key:"removeObject",value:function(e){return Object(N.a)(Object(h.a)(t),"fetchData",this).call(this,"removeObject",e)}}]),t}(C);function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function M(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}I.endpoint="Operation";var R=r.a.createElement("path",{className:"plus",d:"M 14.970703 2.9726562 A 2.0002 2.0002 0 0 0 13 5 L 13 13 L 5 13 A 2.0002 2.0002 0 1 0 5 17 L 13 17 L 13 25 A 2.0002 2.0002 0 1 0 17 25 L 17 17 L 25 17 A 2.0002 2.0002 0 1 0 25 13 L 17 13 L 17 5 A 2.0002 2.0002 0 0 0 14.970703 2.9726562 z"}),B=function(e){var t=e.svgRef,a=e.title,n=M(e,["svgRef","title"]);return r.a.createElement("svg",T({viewBox:"-3 -3 36 36",ref:t},n),a?r.a.createElement("title",null,a):null,R)},H=r.a.forwardRef((function(e,t){return r.a.createElement(B,T({svgRef:t},e))})),x=(a.p,function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"getData",value:function(e,t){D.getProjectList(e).then((function(e){t({projects:e})}))}},{key:"getAddProjectPopupTemplate",value:function(){return r.a.createElement("div",{className:"Popup"},r.a.createElement("div",{className:"Popup-head"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442"),r.a.createElement("div",{className:"Popup-body"},r.a.createElement("div",{className:"Popup-body-row"},r.a.createElement("span",{className:"Popup-body-row-name"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),r.a.createElement("input",{className:"Popup-body-row-input",value:this.getPopupPropValue("title"),onChange:this.popupDataChange.bind(this,"title")})),r.a.createElement("div",{className:"Popup-body-row"},r.a.createElement("span",{className:"Popup-body-row-name"},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),r.a.createElement("div",{className:"Popup-body-row-textarea-scroll"},r.a.createElement("textarea",{className:"Popup-body-row-textarea",value:this.getPopupPropValue("description"),onChange:this.popupDataChange.bind(this,"description")})))),r.a.createElement("div",{className:"Popup-footer Popup-footer-rightAlign"},r.a.createElement("div",{className:"Popup-footer-button buttonOK",onClick:this.confirmAdd.bind(this)},"\u041e\u041a"),r.a.createElement("div",{className:"Popup-footer-button buttonCancel",onClick:this.cancelAdd.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430")))}},{key:"confirmAdd",value:function(){this.closePopup()}},{key:"cancelAdd",value:function(){this.closePopup(!0)}},{key:"_openConstructor",value:function(e){this.appHandlers.pageChange("Constructor",{key:e.key,title:e.title})}},{key:"_addProject",value:function(){var e=this;this.openPopup(this.getAddProjectPopupTemplate.bind(this),{title:"",description:""}).then((function(t){""===t.title||D.addProject(t).then((function(){e.reloadPage()}))}))}},{key:"getRender",value:function(){var e=this;return r.a.createElement("div",{className:"Main"},r.a.createElement(w.a,{style:{width:"100%",height:"100%"}},r.a.createElement("div",{className:"Main-scrollContainer"},this.state.pageData.projects.map((function(t){return r.a.createElement("div",{key:t.key,className:"Main-project",onClick:e._openConstructor.bind(e,t)},r.a.createElement("div",{className:"Main-project-title",title:t.title},t.title),r.a.createElement("div",{className:"Main-project-description"},t.description))})),r.a.createElement("div",{className:"Main-project Main-project-image",onClick:this._addProject.bind(this)},r.a.createElement(H,{className:"Main-project-image-plus"})))))}}]),t}(S)),V=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).test=e.config.test,a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"Account"},this.test)}}]),t}(o.Component),J=a(8),F=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).openSelector=e.openSelector.bind(Object(J.a)(a)),a.inCorrectData=!1,a.rpc=a.operationRPC.bind(Object(J.a)(a)),a.captions=a.operationCaptions(),-1!==e.id&&a.setData(a.props.id),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"operationRPC",value:function(){throw Error("RPC of this operation must be declared in child class")}},{key:"operationCaptions",value:function(){throw Error("Caption of this operation must be declared in child class")}},{key:"componentDidUpdate",value:function(e,t){e.id!==this.props.id&&this.setData(this.props.id)}},{key:"setData",value:function(e){var t=this;this.rpc(e).then((function(e){e?t.setState({operation:e,id:t.props.id}):t.inCorrectData=!0}))}},{key:"render",value:function(){return-1===this.props.id||this.inCorrectData?r.a.createElement("div",{className:"Operation-EmptyData ProjectStage-operation-container-activeArea",onClick:this.openSelector},this.captions.selector):this.state&&-1!==this.state.id?r.a.createElement("div",{className:"Operation"},this.state.operation&&r.a.createElement("div",{className:"Operation-container"},r.a.createElement("div",{className:"Operation-container-type"},this.captions.typeCaption),r.a.createElement("div",{className:"Operation-container-title"},this.state.operation.title))):r.a.createElement("div",{className:"Operation-loading"},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430")}}]),t}(r.a.Component),Z=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"operationRPC",value:function(e){return I.getAction(e)}},{key:"operationCaptions",value:function(){return{typeCaption:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435",selector:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"}}}]),t}(F),U=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"operationRPC",value:function(e){return I.getActor(e)}},{key:"operationCaptions",value:function(){return{typeCaption:"\u0418\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c",selector:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f"}}}]),t}(F),K=function(e){function t(){return t(l.a)(this,t),t(d.a)(this,t(h.a)(t).apply(this,arguments))}return t(m.a)(t,e),t(u.a)(t,[{key:"operationRPC",value:function(e){return I.getObject(e)}},{key:"operationCaptions",value:function(){return{typeCaption:"\u041e\u0431\u044a\u0435\u043a\u0442",selector:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442"}}}]),t}(F);function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e)))._openPopup=a.props.popupHandlers().open.bind(Object(J.a)(a)),a._closePopup=a.props.popupHandlers().close.bind(Object(J.a)(a)),a._updatePopup=a.props.popupHandlers().update.bind(Object(J.a)(a)),a._getPopupValue=a.props.popupHandlers().getValue.bind(Object(J.a)(a)),a._setPopupValue=a.props.popupHandlers().setValue.bind(Object(J.a)(a)),a._addOperation=a.props.constructorHandlers().add.bind(Object(J.a)(a)),a._updateOperation=a.props.constructorHandlers().update.bind(Object(J.a)(a)),a._startLoading=a.props.loadingHandlers().start.bind(Object(J.a)(a)),a._stopLoading=a.props.loadingHandlers().stop.bind(Object(J.a)(a)),a.state={popupList:[],stageData:e.stageData,addTitle:"",addDescription:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"selectorPopup",value:function(e,t,a){var n=this;return r.a.createElement("div",{className:"Popup"},r.a.createElement("div",{className:"Popup-head"},a),r.a.createElement("div",{className:"Popup-body"},!!this.state.popupList.length&&r.a.createElement("div",{className:"Popup-body-heading"},r.a.createElement("span",{className:"Popup-body-heading-column col-2"},"ID"),r.a.createElement("span",{className:"Popup-body-heading-column col-8"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435")),this.state.popupList.map((function(a){return r.a.createElement("div",{key:a.key,className:"Popup-body-rowItem",onClick:n.selectItem.bind(n,e,t,a.key)},r.a.createElement("span",{className:"Popup-body-rowItem-column col-2"},a.key),r.a.createElement("span",{className:"Popup-body-rowItem-column col-6"},a.title),r.a.createElement("div",{className:"Popup-body-rowItem-button col-2",onClick:function(o){return n.deleteItem(o,e,t,a.key)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}))),r.a.createElement("div",{className:"Popup-footer"},r.a.createElement("span",{className:"Popup-body-row-name"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),r.a.createElement("input",{className:"Popup-body-row-input",value:this._getPopupValue("title"),onChange:this.popupDataChange.bind(this,"title")}),r.a.createElement("div",{className:"Popup-body-row-accept",onClick:this.addItem.bind(this,e,{title:this._getPopupValue("title")})},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}},{key:"openSelector",value:function(e,t,a){var n=this;this._startLoading(),I["get".concat(e,"sList")]().then((function(o){n._stopLoading(),n.setState({popupList:o}),n._openPopup(n.selectorPopup.bind(n,e,t,a),Object(p.a)({title:""},e,null))}))}},{key:"addItem",value:function(e,t){var a=this;I["add"+e](t).then((function(e){a.setState({popupList:[].concat(Object(A.a)(a.state.popupList),[q({key:e},t)])}),a._updatePopup()}))}},{key:"deleteItem",value:function(e,t,a,n){var o=this;e.stopPropagation(),I["remove"+t](n).then((function(e){o.setState({popupList:e})}))}},{key:"selectItem",value:function(e,t,a){var n=this;this.state.stageData.operations.some((function(o,r){return o.key===t&&(o[function(){switch(e){case"Actor":return"actor";case"Action":return"action";case"Object":return"object";default:throw Error("Unknown item name")}}()]=a,n._setPopupValue(e,a),n._updateOperation(n.props.stageIndex,r,o),!0)})),this._closePopup()}},{key:"addOperationHandler",value:function(){var e=this;this.state.addTitle&&this.state.addDescription&&(this._addOperation(this.props.stageIndex,{key:this.state.stageData.operations.length?Math.max.apply(Math,Object(A.a)(this.state.stageData.operations.map((function(e){return e.key}))))+1:0,title:this.state.addTitle,description:this.state.addDescription,actor:-1,object:-1,action:-1}),this.setState({addTitle:"",addDescription:"",initNewOperation:!0}),setTimeout((function(){e.setState({initNewOperation:!1})}),300))}},{key:"addTitleChanged",value:function(e){this.setState({addTitle:e.target.value})}},{key:"addDescriptionChanged",value:function(e){this.setState({addDescription:e.target.value})}},{key:"popupDataChange",value:function(e,t){this._setPopupValue(e,t.target.value)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"ProjectStage".concat(this.state.initNewOperation?" ProjectStage-init":"")},r.a.createElement("div",{className:"ProjectStage-header"},r.a.createElement("div",{className:"ProjectStage-header-title",title:"\u042d\u0442\u0430\u043f: "+this.state.stageData.title},r.a.createElement("div",{className:"ProjectStage-header-title-top"},"\u042d\u0442\u0430\u043f"),r.a.createElement("div",{className:"ProjectStage-header-title-bottom"},this.state.stageData.title))),this.state.stageData.operations.map((function(t){return r.a.createElement("div",{key:t.key,className:"ProjectStage-operation"},r.a.createElement("div",{className:"ProjectStage-operation-column-info"},r.a.createElement("div",{className:"ProjectStage-operation-title"},t.title),r.a.createElement("div",{className:"ProjectStage-operation-description-scrollContainer"},r.a.createElement("div",{className:"ProjectStage-operation-description-content"},t.description)),r.a.createElement("div",{className:"ProjectStage-operation-bottomInnerShadow"})),r.a.createElement("div",{className:"ProjectStage-operation-column-interactive"},r.a.createElement("div",{className:"ProjectStage-operation-container"},r.a.createElement(U,{id:t.actor,openSelector:e.openSelector.bind(e,"Actor",t.key,"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f")})),r.a.createElement("div",{className:"ProjectStage-operation-container"},r.a.createElement(Z,{id:t.action,openSelector:e.openSelector.bind(e,"Action",t.key,"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435")})),r.a.createElement("div",{className:"ProjectStage-operation-container"},r.a.createElement(K,{id:t.object,openSelector:e.openSelector.bind(e,"Object",t.key,"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442")}))))})),r.a.createElement("div",{className:"ProjectStage-addTemplate"},r.a.createElement("div",{className:"ProjectStage-operation-column-info-input"},r.a.createElement("input",{className:"ProjectStage-operation-title-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438",onChange:this.addTitleChanged.bind(this),value:this.state.addTitle}),r.a.createElement("div",{className:"ProjectStage-operation-description-scrollContainer-input"},r.a.createElement("textarea",{className:"ProjectStage-operation-description-content-input",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",onChange:this.addDescriptionChanged.bind(this),value:this.state.addDescription}))),r.a.createElement("div",{className:"ProjectStage-operation-column-interactive-input"},r.a.createElement("div",{className:"ProjectStage-operation-button",onClick:this.addOperationHandler.bind(this)},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),r.a.createElement("div",{className:"ProjectStage-addTemplate-bottomLine"})))}}]),t}(r.a.Component),W=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"getData",value:function(e,t){var a=this;this.projectKey=e.key,_.getStagesList(this.projectKey).then((function(e){t({stages:e.stages||[]}),a.setState({navBarActions:a.getNavBarActions()})}))}},{key:"getNavBarActions",value:function(){return r.a.createElement("div",{className:"App-body-navBar-actions-addButton",onClick:this._addStage.bind(this)},r.a.createElement(H,null))}},{key:"getAddStagePopupTemplate",value:function(){return r.a.createElement("div",{className:"Popup"},r.a.createElement("div",{className:"Popup-head"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044d\u0442\u0430\u043f"),r.a.createElement("div",{className:"Popup-body"},r.a.createElement("div",{className:"Popup-body-row"},r.a.createElement("span",{className:"Popup-body-row-name"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),r.a.createElement("input",{className:"Popup-body-row-input",value:this.getPopupPropValue("title"),onChange:this.popupDataChange.bind(this,"title")}))),r.a.createElement("div",{className:"Popup-footer Popup-footer-rightAlign"},r.a.createElement("div",{className:"Popup-footer-button buttonOK",onClick:this.confirmAdd.bind(this)},"\u041e\u041a"),r.a.createElement("div",{className:"Popup-footer-button buttonCancel",onClick:this.cancelAdd.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430")))}},{key:"confirmAdd",value:function(){this.closePopup()}},{key:"cancelAdd",value:function(){this.closePopup(!0)}},{key:"_addStage",value:function(){var e=this;this.openPopup(this.getAddStagePopupTemplate.bind(this),{title:""}).then((function(t){""===t.title||e._updateStagesList([].concat(Object(A.a)(e.state.pageData.stages),[{title:t.title,operations:[]}])).then((function(){e.setState({initNewStage:!0}),setTimeout((function(){e.setState({initNewStage:!1})}),300)}))}))}},{key:"_updateStagesList",value:function(e){var t=this;return _.updateStagesList(this.projectKey,{key:this.projectKey,stages:e}).then((function(e){t.setState({pageData:{stages:e.stages}})}))}},{key:"addOperation",value:function(e,t){this.state.pageData.stages[e].operations.push(t),this._updateStagesList(this.state.pageData.stages)}},{key:"updateOperation",value:function(e,t,a){this.state.pageData.stages[e].operations[t]=a,this._updateStagesList(this.state.pageData.stages)}},{key:"constructorHandlers",value:function(){return{add:this.addOperation.bind(this),update:this.updateOperation.bind(this)}}},{key:"getRender",value:function(){var e=this;return r.a.createElement("div",{className:"Constructor"},r.a.createElement(w.a,{style:{width:"100%",height:"100%"}},r.a.createElement("div",{className:"Constructor-scrollContainer"},r.a.createElement("div",{className:"Constructor-stagesLine".concat(this.state.initNewStage?" Constructor-stagesLine-init":"")},this.state.pageData.stages.map((function(t,a){return r.a.createElement(z,{key:a,stageIndex:a,stageData:t,popupHandlers:e.popupHandlers.bind(e),loadingHandlers:e.loadingHandlers.bind(e),constructorHandlers:e.constructorHandlers.bind(e)})}))))))}}]),t}(S),Y=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"ErrorPage-body"},'You are trying to load unknown page "',this.props.config.moduleName,'"')}}]),t}(r.a.Component);function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Q(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var X=r.a.createElement("path",{className:"back-button",d:"M9.929,12l3.821-3.821c0.414-0.414,0.414-1.086,0-1.5l0,0c-0.414-0.414-1.086-0.414-1.5,0l-4.614,4.614 c-0.391,0.391-0.391,1.024,0,1.414l4.614,4.614c0.414,0.414,1.086,0.414,1.5,0h0c0.414-0.414,0.414-1.086,0-1.5L9.929,12z"}),ee=function(e){var t=e.svgRef,a=e.title,n=Q(e,["svgRef","title"]);return r.a.createElement("svg",$({viewBox:"0 0 24 24",ref:t},n),a?r.a.createElement("title",null,a):null,X)},te=r.a.forwardRef((function(e,t){return r.a.createElement(ee,$({svgRef:t},e))}));a.p;function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var ne=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={pageComponent:a._exportFromLib(n,e.startPage),pageConfig:e.config,route:[{page:e.startPage,config:e.config}],title:e.config.title},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"_pageChange",value:function(e,t){var a=this.state.route,o={page:e,config:t};e||(a.pop(),o=a.pop()),a.push(o);var r=this._exportFromLib(n,o.page),i={pageComponent:r||Y,pageConfig:r?o.config:{moduleName:o.page}};this.setState(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},i,{title:o.config.title}))}},{key:"_goBack",value:function(){this.setState({navBarActions:void 0}),this._pageChange()}},{key:"_exportFromLib",value:function(e,t){return!!e.hasOwnProperty(t)&&e[t]}},{key:"_getPageData",value:function(){return[this.state.pageComponent,this.state.pageConfig]}},{key:"_setNavBarActions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState({navBarActions:e})}},{key:"_getAppHandlers",value:function(){return{pageChange:this._pageChange.bind(this),setNavBarActions:this._setNavBarActions.bind(this)}}},{key:"render",value:function(){var e=this._getPageData(),t=Object(s.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"App-body"},r.a.createElement("div",{className:"App-body-navBar"},r.a.createElement("div",{className:this.state.route.length>1?"App-body-navBar-backButton":"App-body-navBar-backButton-hidden",onClick:this._goBack.bind(this)},r.a.createElement(te,null)),this.state.title&&r.a.createElement("div",{className:"App-body-navBar-title",title:this.state.title},this.state.title),r.a.createElement("div",{className:"App-body-navBar-actions"},this.state.navBarActions)),r.a.createElement(a,{config:n,appHandlers:this._getAppHandlers()})),r.a.createElement("div",{className:"App-menu"}))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(26);c.a.render(r.a.createElement(ne,{startPage:"Main",config:{title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}}),document.getElementById("Application")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[19,1,2]]]);
//# sourceMappingURL=main.3265b19b.chunk.js.map