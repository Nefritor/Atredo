(this.webpackJsonpatredo=this.webpackJsonpatredo||[]).push([[0],{31:function(t,e,a){t.exports=a(58)},57:function(t,e,a){},58:function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"Main",(function(){return U})),a.d(n,"Account",(function(){return G})),a.d(n,"Constructor",(function(){return tt}));var r=a(0),o=a.n(r),i=a(17),c=a.n(i),s=a(30),p=a(12),u=a(3),l=a(4),d=a(5),h=a(2),m=a(6);function b(){return(b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t}).apply(this,arguments)}function f(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var g=o.a.createElement("path",{fill:"url(#darkGradient)"},o.a.createElement("animate",{attributeName:"d",dur:"1000ms",repeatCount:"indefinite",keyTimes:"0;                              .33;                              .66;                              1",calcMode:"spline",keySplines:"0.8 0 0.2 1;                                0.8 0 0.2 1;                                0.8 0 0.2 1;",values:"                            M 100 50                            A 1 1 90 1 0 100 70                            L 100 70                            A 1 1 90 1 0 100 50                            L 100 50                            Z;                            M 100 50                            A 1 1 90 1 0 100 70                            L 200 70                            A 1 1 90 1 0 200 50                            L 100 50                            Z;                            M 200 50                            A 1 1 90 1 0 200 70                            L 200 70                            A 1 1 90 1 0 200 50                            L 200 50                            Z;                            M 200 150                            A 1 1 90 1 0 200 170                            L 200 170                            A 1 1 90 1 0 200 150                            L 200 150                            Z;"})),v=o.a.createElement("path",{fill:"url(#darkGradient)"},o.a.createElement("animate",{attributeName:"d",dur:"1000ms",repeatCount:"indefinite",keyTimes:"0;                                .33;                                .66;                                1",calcMode:"spline",keySplines:"0.8 0 0.2 1;                                  0.8 0 0.2 1;                                  0.8 0 0.2 1;",values:"                              M 150 100                              A 1 1 90 1 0 150 120                              L 150 120                              A 1 1 90 1 0 150 100                              L 150 100                              Z;                              M 100 100                              A 1 1 90 1 0 100 120                              L 200 120                              A 1 1 90 1 0 200 100                              L 100 100                              Z;                              M 150 100                              A 1 1 90 1 0 150 120                              L 150 120                              A 1 1 90 1 0 150 100                              L 150 100                              Z;                              M 150 100                              A 1 1 90 1 0 150 120                              L 150 120                              A 1 1 90 1 0 150 100                              L 150 100                              Z;"})),j=o.a.createElement("path",{fill:"url(#darkGradient)"},o.a.createElement("animate",{attributeName:"d",dur:"1000ms",repeatCount:"indefinite",keyTimes:"0;                                  .33;                                  .66;                                  1",calcMode:"spline",keySplines:"0.8 0 0.2 1;                                    0.8 0 0.2 1;                                    0.8 0 0.2 1;",values:"                                M 200 150                                A 1 1 90 1 0 200 170                                L 200 170                                A 1 1 90 1 0 200 150                                L 200 150                                Z;                                M 100 150                                A 1 1 90 1 0 100 170                                L 200 170                                A 1 1 90 1 0 200 150                                L 100 150                                Z;                                M 100 150                                A 1 1 90 1 0 100 170                                L 100 170                                A 1 1 90 1 0 100 150                                L 100 150                                Z;                                M 100 50                                A 1 1 90 1 0 100 70                                L 100 70                                A 1 1 90 1 0 100 50                                L 100 50                                Z;"})),O=o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"darkGradient",x1:"30%",y1:"70%"},o.a.createElement("stop",{offset:"20%",stopColor:"#d54bec"},o.a.createElement("animate",{attributeName:"stop-color",dur:"3000ms",values:"#d54bec; #f13e3e; #d54bec",repeatCount:"indefinite"})),o.a.createElement("stop",{offset:"80%",stopColor:"#f754c3"},o.a.createElement("animate",{attributeName:"stop-color",dur:"3000ms",values:"#f754c3; #f1603e; #f754c3",repeatCount:"indefinite"})))),y=function(t){var e=t.svgRef,a=t.title,n=f(t,["svgRef","title"]);return o.a.createElement("svg",b({viewBox:"0 0 300 230",ref:e},n),a?o.a.createElement("title",null,a):null,g,v,j,O)},P=o.a.forwardRef((function(t,e){return o.a.createElement(y,b({svgRef:e},t))}));a.p;function k(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?k(a,!0).forEach((function(e){Object(p.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var w=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(d.a)(this,Object(h.a)(e).call(this,t))).appHandlers=t.appHandlers,a.state={dataReady:!1,loading:{show:!0,transparent:!0},popup:{show:!1,transparent:!0},navBarActions:void 0},a.reloadPage(),a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"reloadPage",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.config;new Promise((function(a){t.startLoading(),t.getData(e,a)})).then((function(e){t.setState({pageData:e}),t.appHandlers.setNavBarActions(t.state.navBarActions),t.stopLoading()}))}},{key:"startLoading",value:function(){var t=this;this.loadingTimeout=setTimeout((function(){t.setState({loading:{show:!0,transparent:!1}})}),0)}},{key:"stopLoading",value:function(){var t=this;clearTimeout(this.loadingTimeout),this.setState({loading:{show:!0,transparent:!0},dataReady:!0}),setTimeout((function(){t.setState({loading:{show:!1,transparent:!0}})}),300)}},{key:"openPopup",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){!1===e.state.popup.show&&t?(e.setState({popupComponent:t,popupData:a,popup:{show:!0,transparent:!0}}),setTimeout((function(){e.setState({popup:{show:!0,transparent:!1}})}),0),e.popupDataReady=Promise.resolve(),e.closePopupResolver=n.bind(e)):t?(console.warn("Popup opening try has been observed and cancelled"),r()):(console.warn("Trying to open popup without template"),r())}))}},{key:"closePopup",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.closePopupResolver?this.popupDataReady.then((function(){e||t.closePopupResolver(t.state.popupData),t.closePopupResolver=void 0,t.setState({popup:{show:!0,transparent:!0}}),setTimeout((function(){t.setState({popupComponent:void 0,popupData:void 0,popup:{show:!1,transparent:!0}})}),300)})):console.warn("There is no active popup")}},{key:"updatePopup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.popupComponent,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.popupData;this.setState({popupComponent:t,popupData:e})}},{key:"popupHandlers",value:function(){return{open:this.openPopup.bind(this),close:this.closePopup.bind(this),update:this.updatePopup.bind(this),getValue:this.getPopupPropValue.bind(this),setValue:this.setPopupPropValue.bind(this)}}},{key:"loadingHandlers",value:function(){return{start:this.startLoading.bind(this),stop:this.stopLoading.bind(this)}}},{key:"popupDataChange",value:function(t,e){this.setPopupPropValue(t,e.target.value)}},{key:"setPopupPropValue",value:function(t,e){var a=this;this.popupDataReady=new Promise((function(n){a.setState({popupData:E({},a.state.popupData,Object(p.a)({},t,e))},(function(){n()}))}))}},{key:"getPopupPropValue",value:function(t){return this.state.popupData[t]}},{key:"popupBackgroundClick",value:function(t){"popupBackground"===t.target.id&&this.closePopup(!0)}},{key:"getData",value:function(){throw Error("Data getter must be declared inside child component")}},{key:"getRender",value:function(){throw Error("Renderer must be declared inside child component")}},{key:"getLoadingClassName",value:function(t,e){return t.show?t.transparent?"".concat(e,"-transparent"):"".concat(e,"-loading"):"".concat(e,"-hidden")}},{key:"getLoader",value:function(){return o.a.createElement("div",{className:this.getLoadingClassName(this.state.loading,"App-body-page-loadingAnimation")},o.a.createElement(P,{className:"App-body-page-loadingAnimation"}))}},{key:"getPopup",value:function(){return o.a.createElement("div",{className:"App-body-page-popup ".concat(this.getLoadingClassName(this.state.popup,"App-body-page-popup")),onClick:this.popupBackgroundClick.bind(this),id:"popupBackground"},o.a.createElement(this.state.popupComponent,null))}},{key:"render",value:function(){return o.a.createElement("div",{className:"App-body-page"},this.state.dataReady&&this.getRender(),this.state.loading.show&&this.getLoader(),this.state.popup.show&&this.getPopup())}}]),e}(o.a.Component),N=a(15),A=a(7),C=a(13),S=a.n(C),D=a(16),L=a(8),_=a.n(L),x="http://13.48.194.48:5000",M=function(){function t(){Object(u.a)(this,t)}return Object(l.a)(t,null,[{key:"fetchData",value:function(t,e,a){var n=this;if(this.endpoint)return new Promise((function(r){setTimeout((function(){r(function(){switch(n.endpoint){case"Main":return n._fromMain(t,e);case"Operation":return n._fromOperations(t,e);case"Project":return n._fromProjects(t,e,a);default:throw Error('Unknown endpoint "'.concat(n.endpoint,'"'))}}())}),300)}));throw Error('There is no endpoint at "'.concat(t,'" request'))}},{key:"_fromMain",value:function(){var t=Object(D.a)(S.a.mark((function t(e,a){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="getProjectList"===t.t0?3:"addProject"===t.t0?6:9;break;case 3:return t.next=5,_.a.get(x+"/projects/");case 5:return t.abrupt("return",t.sent);case 6:return t.next=8,_.a.post(x+"/projects/",a);case 8:return t.abrupt("return",t.sent);case 9:throw Error('Unknown request "'.concat(this.endpoint,".").concat(e,'"'));case 10:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"_fromOperations",value:function(){var t=Object(D.a)(S.a.mark((function t(e,a){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="getAction"===t.t0?3:"getActor"===t.t0?6:"getObject"===t.t0?9:"getActionsList"===t.t0?12:"getActorsList"===t.t0?15:"getObjectsList"===t.t0?18:"addAction"===t.t0?21:"addActor"===t.t0?24:"addObject"===t.t0?27:"removeAction"===t.t0?30:"removeActor"===t.t0?33:"removeObject"===t.t0?36:39;break;case 3:return t.next=5,_.a.get(x+"/action/"+a+"/");case 5:return t.abrupt("return",t.sent);case 6:return t.next=8,_.a.get(x+"/actor/"+a+"/");case 8:return t.abrupt("return",t.sent);case 9:return t.next=11,_.a.get(x+"/object/"+a+"/");case 11:return t.abrupt("return",t.sent);case 12:return t.next=14,_.a.get(x+"/actions/");case 14:return t.abrupt("return",t.sent);case 15:return t.next=17,_.a.get(x+"/actors/");case 17:return t.abrupt("return",t.sent);case 18:return t.next=20,_.a.get(x+"/objects/");case 20:return t.abrupt("return",t.sent);case 21:return t.next=23,_.a.post(x+"/actions/",{data:a});case 23:return t.abrupt("return",t.sent);case 24:return t.next=26,_.a.post(x+"/actors/",{data:a});case 26:return t.abrupt("return",t.sent);case 27:return t.next=29,_.a.post(x+"/objects/",{data:a});case 29:return t.abrupt("return",t.sent);case 30:return t.next=32,_.a.delete(x+"/object/"+a+"/");case 32:return t.abrupt("return",t.sent);case 33:return t.next=35,_.a.delete(x+"/actor/"+a+"/");case 35:return t.abrupt("return",t.sent);case 36:return t.next=38,_.a.delete(x+"/object/"+a+"/");case 38:return t.abrupt("return",t.sent);case 39:throw Error('Unknown request "'.concat(this.endpoint,".").concat(e,'"'));case 40:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"_fromProjects",value:function(){var t=Object(D.a)(S.a.mark((function t(e,a,n){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="getStagesList"===t.t0?3:"addStage"===t.t0?6:"updateStagesList"===t.t0?9:12;break;case 3:return t.next=5,_.a.get(x+/stage/+a+"/");case 5:return t.abrupt("return",t.sent);case 6:return t.next=8,_.a.post(x+/stages/,n);case 8:return t.abrupt("return",t.sent);case 9:return t.next=11,_.a.put(x+/stage/+a+"/",{data:n});case 11:return t.abrupt("return",t.sent);case 12:throw Error('Unknown request "'.concat(this.endpoint,".").concat(e,'"'));case 13:case"end":return t.stop()}}),t,this)})));return function(e,a,n){return t.apply(this,arguments)}}()}]),t}(),R=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,null,[{key:"getProjectList",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getProjectList",t)}},{key:"addProject",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"addProject",t)}},{key:"endpoint",get:function(){return"Main"}}]),e}(M),B=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,null,[{key:"getStagesList",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getStagesList",t)}},{key:"addStage",value:function(t,a){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"addStage",t,a)}},{key:"updateStagesList",value:function(t,a){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"updateStagesList",t,a)}}]),e}(M);B.endpoint="Project";var T=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,null,[{key:"getAction",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getAction",t)}},{key:"getActor",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getActor",t)}},{key:"getObject",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getObject",t)}},{key:"getActionsList",value:function(){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getActionsList")}},{key:"getActorsList",value:function(){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getActorsList")}},{key:"getObjectsList",value:function(){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"getObjectsList")}},{key:"addAction",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"addAction",t)}},{key:"addActor",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"addActor",t)}},{key:"addObject",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"addObject",t)}},{key:"removeAction",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"removeAction",t)}},{key:"removeActor",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"removeActor",t)}},{key:"removeObject",value:function(t){return Object(A.a)(Object(h.a)(e),"fetchData",this).call(this,"removeObject",t)}}]),e}(M);function H(){return(H=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t}).apply(this,arguments)}function I(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}T.endpoint="Operation";var V=o.a.createElement("path",{className:"plus",d:"M 14.970703 2.9726562 A 2.0002 2.0002 0 0 0 13 5 L 13 13 L 5 13 A 2.0002 2.0002 0 1 0 5 17 L 13 17 L 13 25 A 2.0002 2.0002 0 1 0 17 25 L 17 17 L 25 17 A 2.0002 2.0002 0 1 0 25 13 L 17 13 L 17 5 A 2.0002 2.0002 0 0 0 14.970703 2.9726562 z"}),Z=function(t){var e=t.svgRef,a=t.title,n=I(t,["svgRef","title"]);return o.a.createElement("svg",H({viewBox:"-3 -3 36 36",ref:e},n),a?o.a.createElement("title",null,a):null,V)},K=o.a.forwardRef((function(t,e){return o.a.createElement(Z,H({svgRef:e},t))})),U=(a.p,function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"getData",value:function(t,e){R.getProjectList(t).then((function(t){e({projects:t})}))}},{key:"getAddProjectPopupTemplate",value:function(){return o.a.createElement("div",{className:"Popup"},o.a.createElement("div",{className:"Popup-head"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442"),o.a.createElement("div",{className:"Popup-body"},o.a.createElement("div",{className:"Popup-body-row"},o.a.createElement("span",{className:"Popup-body-row-name"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),o.a.createElement("input",{className:"Popup-body-row-input",value:this.getPopupPropValue("title"),onChange:this.popupDataChange.bind(this,"title")})),o.a.createElement("div",{className:"Popup-body-row"},o.a.createElement("span",{className:"Popup-body-row-name"},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),o.a.createElement("div",{className:"Popup-body-row-textarea-scroll"},o.a.createElement("textarea",{className:"Popup-body-row-textarea",value:this.getPopupPropValue("description"),onChange:this.popupDataChange.bind(this,"description")})))),o.a.createElement("div",{className:"Popup-footer Popup-footer-rightAlign"},o.a.createElement("div",{className:"Popup-footer-button buttonOK",onClick:this.confirmAdd.bind(this)},"\u041e\u041a"),o.a.createElement("div",{className:"Popup-footer-button buttonCancel",onClick:this.cancelAdd.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430")))}},{key:"confirmAdd",value:function(){this.closePopup()}},{key:"cancelAdd",value:function(){this.closePopup(!0)}},{key:"_openConstructor",value:function(t){this.appHandlers.pageChange("Constructor",{_id:t._id,title:t.title})}},{key:"_addProject",value:function(){var t=this;this.openPopup(this.getAddProjectPopupTemplate.bind(this),{title:"",description:""}).then((function(e){""===e.title||R.addProject(e).then((function(){t.reloadPage()}))}))}},{key:"getRender",value:function(){var t=this;return o.a.createElement("div",{className:"Main"},o.a.createElement(N.a,{style:{width:"100%",height:"100%"}},o.a.createElement("div",{className:"Main-scrollContainer"},Array.from(this.state.pageData.projects).map((function(e){return o.a.createElement("div",{key:e._id,className:"Main-project",onClick:t._openConstructor.bind(t,e)},o.a.createElement("div",{className:"Main-project-title",title:e.title},e.title),o.a.createElement("div",{className:"Main-project-description"},e.description))})),o.a.createElement("div",{className:"Main-project Main-project-image",onClick:this._addProject.bind(this)},o.a.createElement(K,{className:"Main-project-image-plus"})))))}}]),e}(w)),G=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(d.a)(this,Object(h.a)(e).call(this,t))).test=t.config.test,a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"Account"},this.test)}}]),e}(r.Component),q=a(14),F=a(9),z=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(d.a)(this,Object(h.a)(e).call(this,t))).openSelector=t.openSelector.bind(Object(F.a)(a)),a.inCorrectData=!1,a.rpc=a.operationRPC.bind(Object(F.a)(a)),a.captions=a.operationCaptions(),-1!==t.id&&a.setData(a.props.id),a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"operationRPC",value:function(){throw Error("RPC of this operation must be declared in child class")}},{key:"operationCaptions",value:function(){throw Error("Caption of this operation must be declared in child class")}},{key:"componentDidUpdate",value:function(t,e){t.id!==this.props.id&&this.setData(this.props.id)}},{key:"setData",value:function(t){var e=this;this.rpc(t).then((function(t){t?e.setState({operation:t,id:e.props.id}):e.inCorrectData=!0}))}},{key:"render",value:function(){return-1===this.props.id||this.inCorrectData?o.a.createElement("div",{className:"Operation-EmptyData ProjectStage-operation-container-activeArea",onClick:this.openSelector},this.captions.selector):this.state&&-1!==this.state.id?o.a.createElement("div",{className:"Operation"},this.state.operation&&o.a.createElement("div",{className:"Operation-container"},o.a.createElement("div",{className:"Operation-container-type"},this.captions.typeCaption),o.a.createElement("div",{className:"Operation-container-title"},this.state.operation.title))):o.a.createElement("div",{className:"Operation-loading"},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430")}}]),e}(o.a.Component),J=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"operationRPC",value:function(t){return T.getAction(t)}},{key:"operationCaptions",value:function(){return{typeCaption:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435",selector:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"}}}]),e}(z),W=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"operationRPC",value:function(t){return T.getActor(t)}},{key:"operationCaptions",value:function(){return{typeCaption:"\u0418\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c",selector:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f"}}}]),e}(z),Y=function(t){function e(){return e(u.a)(this,e),e(d.a)(this,e(h.a)(e).apply(this,arguments))}return e(m.a)(e,t),e(l.a)(e,[{key:"operationRPC",value:function(t){return T.getObject(t)}},{key:"operationCaptions",value:function(){return{typeCaption:"\u041e\u0431\u044a\u0435\u043a\u0442",selector:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442"}}}]),e}(z);function $(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function Q(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?$(a,!0).forEach((function(e){Object(p.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):$(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var X=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(d.a)(this,Object(h.a)(e).call(this,t)))._openPopup=a.props.popupHandlers().open.bind(Object(F.a)(a)),a._closePopup=a.props.popupHandlers().close.bind(Object(F.a)(a)),a._updatePopup=a.props.popupHandlers().update.bind(Object(F.a)(a)),a._getPopupValue=a.props.popupHandlers().getValue.bind(Object(F.a)(a)),a._setPopupValue=a.props.popupHandlers().setValue.bind(Object(F.a)(a)),a._addOperation=a.props.constructorHandlers().add.bind(Object(F.a)(a)),a._updateOperation=a.props.constructorHandlers().update.bind(Object(F.a)(a)),a._startLoading=a.props.loadingHandlers().start.bind(Object(F.a)(a)),a._stopLoading=a.props.loadingHandlers().stop.bind(Object(F.a)(a)),a.state={popupList:[],stageData:t.stageData,addTitle:"",addDescription:""},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"selectorPopup",value:function(t,e,a){var n=this;return o.a.createElement("div",{className:"Popup"},o.a.createElement("div",{className:"Popup-head"},a),o.a.createElement("div",{className:"Popup-body"},!!this.state.popupList.length&&o.a.createElement("div",{className:"Popup-body-heading"},o.a.createElement("span",{className:"Popup-body-heading-column col-2"},"ID"),o.a.createElement("span",{className:"Popup-body-heading-column col-8"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435")),this.state.popupList.map((function(a){return o.a.createElement("div",{key:a._id,className:"Popup-body-rowItem",onClick:n.selectItem.bind(n,t,e,a._id)},o.a.createElement("span",{className:"Popup-body-rowItem-column col-2"},a._id),o.a.createElement("span",{className:"Popup-body-rowItem-column col-6"},a.title),o.a.createElement("div",{className:"Popup-body-rowItem-button col-2",onClick:function(r){return n.deleteItem(r,t,e,a._id)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}))),o.a.createElement("div",{className:"Popup-footer"},o.a.createElement("span",{className:"Popup-body-row-name"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),o.a.createElement("input",{className:"Popup-body-row-input",value:this._getPopupValue("title"),onChange:this.popupDataChange.bind(this,"title")}),o.a.createElement("div",{className:"Popup-body-row-accept",onClick:this.addItem.bind(this,t,{title:this._getPopupValue("title")})},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}},{key:"openSelector",value:function(t,e,a){var n=this;this._startLoading(),T["get".concat(t,"sList")]().then((function(r){n._stopLoading(),n.setState({popupList:r}),n._openPopup(n.selectorPopup.bind(n,t,e,a),Object(p.a)({title:""},t,null))}))}},{key:"addItem",value:function(t,e){var a=this;T["add"+t](e).then((function(t){a.setState({popupList:[].concat(Object(q.a)(a.state.popupList),[Q({key:t},e)])}),a._updatePopup()}))}},{key:"deleteItem",value:function(t,e,a,n){var r=this;t.stopPropagation(),T["remove"+e](n).then((function(t){r.setState({popupList:t}),r._updatePopup()}))}},{key:"selectItem",value:function(t,e,a){var n=this;this.state.stageData.operations.some((function(r,o){return r._id===e&&(r[function(){switch(t){case"Actor":return"actor";case"Action":return"action";case"Object":return"object";default:throw Error("Unknown item name")}}()]=a,n._setPopupValue(t,a),n._updateOperation(n.props.stageIndex,o,r),!0)})),this._closePopup()}},{key:"addOperationHandler",value:function(){var t=this;this.state.addTitle&&this.state.addDescription&&(this._addOperation(this.props.stageIndex,{_id:this.state.stageData.operations.length?Math.max.apply(Math,Object(q.a)(this.state.stageData.operations.map((function(t){return t._id}))))+1:0,title:this.state.addTitle,description:this.state.addDescription,actor:-1,object:-1,action:-1}),this.setState({addTitle:"",addDescription:"",initNewOperation:!0}),setTimeout((function(){t.setState({initNewOperation:!1})}),300))}},{key:"addTitleChanged",value:function(t){this.setState({addTitle:t.target.value})}},{key:"addDescriptionChanged",value:function(t){this.setState({addDescription:t.target.value})}},{key:"popupDataChange",value:function(t,e){this._setPopupValue(t,e.target.value)}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:"ProjectStage".concat(this.state.initNewOperation?" ProjectStage-init":"")},o.a.createElement("div",{className:"ProjectStage-header"},o.a.createElement("div",{className:"ProjectStage-header-title",title:"\u042d\u0442\u0430\u043f: "+this.state.stageData.title},o.a.createElement("div",{className:"ProjectStage-header-title-top"},"\u042d\u0442\u0430\u043f"),o.a.createElement("div",{className:"ProjectStage-header-title-bottom"},this.state.stageData.title))),this.state.stageData.operations.map((function(e){return o.a.createElement("div",{key:e._id,className:"ProjectStage-operation"},o.a.createElement("div",{className:"ProjectStage-operation-column-info"},o.a.createElement("div",{className:"ProjectStage-operation-title"},e.title),o.a.createElement("div",{className:"ProjectStage-operation-description-scrollContainer"},o.a.createElement("div",{className:"ProjectStage-operation-description-content"},e.description))),o.a.createElement("div",{className:"ProjectStage-operation-column-interactive"},o.a.createElement("div",{className:"ProjectStage-operation-container"},o.a.createElement(W,{id:e.actor,openSelector:t.openSelector.bind(t,"Actor",e._id,"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f")})),o.a.createElement("div",{className:"ProjectStage-operation-container"},o.a.createElement(J,{id:e.action,openSelector:t.openSelector.bind(t,"Action",e._id,"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435")})),o.a.createElement("div",{className:"ProjectStage-operation-container"},o.a.createElement(Y,{id:e.object,openSelector:t.openSelector.bind(t,"Object",e._id,"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442")}))))})),o.a.createElement("div",{className:"ProjectStage-addTemplate"},o.a.createElement("div",{className:"ProjectStage-operation-column-info-input"},o.a.createElement("input",{className:"ProjectStage-operation-title-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438",onChange:this.addTitleChanged.bind(this),value:this.state.addTitle}),o.a.createElement("div",{className:"ProjectStage-operation-description-scrollContainer-input"},o.a.createElement("textarea",{className:"ProjectStage-operation-description-content-input",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",onChange:this.addDescriptionChanged.bind(this),value:this.state.addDescription}))),o.a.createElement("div",{className:"ProjectStage-operation-column-interactive-input"},o.a.createElement("div",{className:"ProjectStage-operation-button",onClick:this.addOperationHandler.bind(this)},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),o.a.createElement("div",{className:"ProjectStage-addTemplate-bottomLine"})))}}]),e}(o.a.Component),tt=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"getData",value:function(t,e){var a=this;this.projectKey=t._id,B.getStagesList(this.projectKey).then((function(t){e({stages:t.stages||[]}),a.setState({navBarActions:a.getNavBarActions()})}))}},{key:"getNavBarActions",value:function(){return o.a.createElement("div",{className:"App-body-navBar-actions-addButton",onClick:this._addStage.bind(this)},o.a.createElement(K,null))}},{key:"getAddStagePopupTemplate",value:function(){return o.a.createElement("div",{className:"Popup"},o.a.createElement("div",{className:"Popup-head"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044d\u0442\u0430\u043f"),o.a.createElement("div",{className:"Popup-body"},o.a.createElement("div",{className:"Popup-body-row"},o.a.createElement("span",{className:"Popup-body-row-name"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),o.a.createElement("input",{className:"Popup-body-row-input",value:this.getPopupPropValue("title"),onChange:this.popupDataChange.bind(this,"title")}))),o.a.createElement("div",{className:"Popup-footer Popup-footer-rightAlign"},o.a.createElement("div",{className:"Popup-footer-button buttonOK",onClick:this.confirmAdd.bind(this)},"\u041e\u041a"),o.a.createElement("div",{className:"Popup-footer-button buttonCancel",onClick:this.cancelAdd.bind(this)},"\u041e\u0442\u043c\u0435\u043d\u0430")))}},{key:"confirmAdd",value:function(){this.closePopup()}},{key:"cancelAdd",value:function(){this.closePopup(!0)}},{key:"_addStage",value:function(){var t=this;this.openPopup(this.getAddStagePopupTemplate.bind(this),{title:""}).then((function(e){""===e.title||t._updateStagesList([].concat(Object(q.a)(t.state.pageData.stages),[{title:e.title,operations:[]}])).then((function(){t.setState({initNewStage:!0}),setTimeout((function(){t.setState({initNewStage:!1})}),300)}))}))}},{key:"_updateStagesList",value:function(t){var e=this;return B.updateStagesList(this.projectKey,{_id:this.projectKey,stages:t}).then((function(t){e.setState({pageData:{stages:t.stages}})}))}},{key:"addOperation",value:function(t,e){this.state.pageData.stages[t].operations.push(e),this._updateStagesList(this.state.pageData.stages)}},{key:"updateOperation",value:function(t,e,a){this.state.pageData.stages[t].operations[e]=a,this._updateStagesList(this.state.pageData.stages)}},{key:"constructorHandlers",value:function(){return{add:this.addOperation.bind(this),update:this.updateOperation.bind(this)}}},{key:"getRender",value:function(){var t=this;return o.a.createElement("div",{className:"Constructor"},o.a.createElement(N.a,{style:{width:"100%",height:"100%"}},o.a.createElement("div",{className:"Constructor-scrollContainer"},o.a.createElement("div",{className:"Constructor-stagesLine".concat(this.state.initNewStage?" Constructor-stagesLine-init":"")},this.state.pageData.stages.map((function(e,a){return o.a.createElement(X,{key:a,stageIndex:a,stageData:e,popupHandlers:t.popupHandlers.bind(t),loadingHandlers:t.loadingHandlers.bind(t),constructorHandlers:t.constructorHandlers.bind(t)})}))))))}}]),e}(w),et=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"ErrorPage-body"},'You are trying to load unknown page "',this.props.config.moduleName,'"')}}]),e}(o.a.Component);function at(){return(at=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t}).apply(this,arguments)}function nt(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var rt=o.a.createElement("path",{className:"back-button",d:"M9.929,12l3.821-3.821c0.414-0.414,0.414-1.086,0-1.5l0,0c-0.414-0.414-1.086-0.414-1.5,0l-4.614,4.614 c-0.391,0.391-0.391,1.024,0,1.414l4.614,4.614c0.414,0.414,1.086,0.414,1.5,0h0c0.414-0.414,0.414-1.086,0-1.5L9.929,12z"}),ot=function(t){var e=t.svgRef,a=t.title,n=nt(t,["svgRef","title"]);return o.a.createElement("svg",at({viewBox:"0 0 24 24",ref:e},n),a?o.a.createElement("title",null,a):null,rt)},it=o.a.forwardRef((function(t,e){return o.a.createElement(ot,at({svgRef:e},t))}));a.p;function ct(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}var st=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(d.a)(this,Object(h.a)(e).call(this,t))).state={pageComponent:a._exportFromLib(n,t.startPage),pageConfig:t.config,route:[{page:t.startPage,config:t.config}],title:t.config.title},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"_pageChange",value:function(t,e){var a=this.state.route,r={page:t,config:e};t||(a.pop(),r=a.pop()),a.push(r);var o=this._exportFromLib(n,r.page),i={pageComponent:o||et,pageConfig:o?r.config:{moduleName:r.page}};this.setState(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ct(a,!0).forEach((function(e){Object(p.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ct(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},i,{title:r.config.title}))}},{key:"_goBack",value:function(){this.setState({navBarActions:void 0}),this._pageChange()}},{key:"_exportFromLib",value:function(t,e){return!!t.hasOwnProperty(e)&&t[e]}},{key:"_getPageData",value:function(){return[this.state.pageComponent,this.state.pageConfig]}},{key:"_setNavBarActions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState({navBarActions:t})}},{key:"_getAppHandlers",value:function(){return{pageChange:this._pageChange.bind(this),setNavBarActions:this._setNavBarActions.bind(this)}}},{key:"render",value:function(){var t=this._getPageData(),e=Object(s.a)(t,2),a=e[0],n=e[1];return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"App-body"},o.a.createElement("div",{className:"App-body-navBar"},o.a.createElement("div",{className:this.state.route.length>1?"App-body-navBar-backButton":"App-body-navBar-backButton-hidden",onClick:this._goBack.bind(this)},o.a.createElement(it,null)),this.state.title&&o.a.createElement("div",{className:"App-body-navBar-title",title:this.state.title},this.state.title),o.a.createElement("div",{className:"App-body-navBar-actions"},this.state.navBarActions)),o.a.createElement(a,{config:n,appHandlers:this._getAppHandlers()})),o.a.createElement("div",{className:"App-menu"}))}}]),e}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(57);c.a.render(o.a.createElement(st,{startPage:"Main",config:{title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}}),document.getElementById("Application")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[31,1,2]]]);
//# sourceMappingURL=main.144c005c.chunk.js.map